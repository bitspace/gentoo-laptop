# Optimized make.conf for System76 Kudu6 Gentoo Build
# Bleeding-edge configuration with performance optimization

# Compiler optimization (adjust march based on your CPU)
COMMON_FLAGS="-march=native -O2 -pipe"
CFLAGS="${COMMON_FLAGS}"
CXXFLAGS="${COMMON_FLAGS}"
FCFLAGS="${COMMON_FLAGS}"
FFLAGS="${COMMON_FLAGS}"

# Parallel compilation - adjust based on your CPU cores
# Rule of thumb: CPU cores + 1
MAKEOPTS="-j9"

# Portage features for performance and debugging
FEATURES="parallel-fetch ccache split-debug buildpkg"

# Global USE flags optimized for bleeding-edge multi-purpose system
USE="systemd wayland pipewire vulkan opengl X \
     abi_x86_32 multilib \
     threads lto pgo \
     alsa jack \
     bluetooth udev dbus \
     ssl zstd lz4 \
     python rust java nodejs go \
     cuda rocm \
     git vim-syntax bash-completion \
     pie ssp hardened \
     -pulseaudio -gnome -kde -qt4 -doc"

# Video cards - adjust for your hardware
# For NVIDIA:
VIDEO_CARDS="nvidia"
# For AMD:
# VIDEO_CARDS="amdgpu radeonsi"
# For Intel:
# VIDEO_CARDS="intel i965 iris"

# Input devices
INPUT_DEVICES="libinput"

# Python targets for latest versions
PYTHON_TARGETS="python3_11 python3_12"
PYTHON_SINGLE_TARGET="python3_12"

# Rust optimization
RUSTFLAGS="-C target-cpu=native"

# Accept all licenses for convenience (review if needed)
ACCEPT_LICENSE="*"

# Language support
L10N="en"

# CPU architecture
CHOST="x86_64-pc-linux-gnu"

# Portage directories
PORTDIR="/var/db/repos/gentoo"
DISTDIR="/var/cache/distfiles"
PKGDIR="/var/cache/binpkgs"

# Emerge default options
EMERGE_DEFAULT_OPTS="--ask --verbose --jobs=4 --load-average=4.0"

# For binary packages (optional)
# FEATURES="${FEATURES} getbinpkg"
# PORTAGE_BINHOST="https://packages.gentoo.org"

# ccache configuration
CCACHE_SIZE="8G"
CCACHE_DIR="/var/cache/ccache"